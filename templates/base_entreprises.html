<!DOCTYPE html>
<html>
<head>
    <title>Liste des Entreprises</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <style>
        .search-bar { margin-bottom: 20px; }
        table { width: 100%; }
        th, td { vertical-align: middle; }
    </style>
</head>
<body>
    <h1>Liste des Entreprises</h1>
    {% with messages = get_flashed_messages() %}
        {% if messages %}
            {% for message in messages %}
                <div class="alert alert-info">{{ message }}</div>
            {% endfor %}
        {% endif %}
    {% endwith %}
    <div class="search-bar">
        <input type="text" id="searchInput" class="form-control" placeholder="Rechercher une entreprise...">
    </div>
    <table class="table table-striped table-hover">
        <thead>
            <tr>
                <th>Nom Entreprise</th>
                <th>Forme Juridique</th>
                <th>Représentant Légal</th>
                <th>Qualité</th>
                <th>Adresse</th>
                <th>Code Postal</th>
                <th>Ville</th>
                <th>Téléphone</th>
                <th>Mail Général</th>
                <th>SIRET</th>
                <th>Code APE</th>
                <th>Signataire Doc</th>
                <th>Mail Signataire</th>
                <th>Signataire AR24</th>
                <th>Correspondant Situations</th>
                <th>Mail Correspondant</th>
            </tr>
        </thead>
        <tbody id="entreprisesTable">
            {% for entreprise in entreprises %}
            <tr>
                <td>{{ entreprise.nom_entreprise }}</td>
                <td>{{ entreprise.forme_juridique }}</td>
                <td>{{ entreprise.representant_legal }}</td>
                <td>{{ entreprise.qualite }}</td>
                <td>{{ entreprise.adresse }} {{ entreprise.complement_adresse }}</td>
                <td>{{ entreprise.code_postal }}</td>
                <td>{{ entreprise.ville }}</td>
                <td>{{ entreprise.telephone }}</td>
                <td>{{ entreprise.mail_general }}</td>
                <td>{{ entreprise.siret }}</td>
                <td>{{ entreprise.code_ape }}</td>
                <td>{{ entreprise.nom_signataire_doc }} {{ entreprise.prenom_signataire_doc }} ({{ entreprise.fonction_signataire_doc }})</td>
                <td>{{ entreprise.mail_signataire_doc }}</td>
                <td>{{ entreprise.nom_signataire_ar24 }} {{ entreprise.prenom_signataire_ar24 }} ({{ entreprise.fonction_signataire_ar24 }})</td>
                <td>{{ entreprise.nom_correspondant_situations }} {{ entreprise.prenom_correspondant_situations }}</td>
                <td>{{ entreprise.mail_correspondant_situations }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    <a href="/"><button class="btn btn-secondary">Retour</button></a>
    <script>
        document.getElementById('searchInput').addEventListener('input', function() {
            let input = this.value.toLowerCase();
            let rows = document.getElementById('entreprisesTable').getElementsByTagName('tr');
            for (let i = 0; i < rows.length; i++) {
                let text = rows[i].textContent.toLowerCase();
                rows[i].style.display = text.includes(input) ? '' : 'none';
            }
        });
    </script>
</body>
</html>